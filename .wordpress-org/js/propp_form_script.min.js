!function(a){"use strict";var b={el:"",msgContainer:!1,validPhones:[],submit:function(){var b=this;a(b.el).trigger("submit")},request:function(b){if(!a("body").hasClass("propp-loading")){var c=this;a("body").addClass("propp-loading");var d=a(c.el).find(".propp-phone");_.each(a(d),function(c,d){a(c).val()==b&&a(c).addClass("propp-loading-phone")}),b.length>1?a.ajax({url:propp.AJAX_URL,type:"POST",cache:!1,crossDomain:!0,data:{action:"bppy-verify-phone","prop-nonce":propp.nonce,number:b},dataType:"json",success:function(d){a("body").removeClass("propp-loading");var e=a(c.el).find(".propp-phone");_.each(a(e),function(c,d){a(c).val()==b&&a(c).removeClass("propp-loading-phone")}),0!=d.is_valid?(c.validPhones.push(b),c.submit()):c.showError(b,d.status)},error:function(){a("body").removeClass("propp-loading")}}):(a("body").removeClass("propp-loading"),c.showError(b,"UNKNOWN"))}},validateForm:function(c){var d=this,e=a(c).find(".propp-phone");d.el=c,a(d.el).find(".wpcf7-response-output").length?d.msgContainer=a(d.el).find(".wpcf7-response-output"):d.msgContainer=!1;var f=[],e=a(c).find(".propp-phone");if(_.each(e,function(b,c){f.push(a(e[c]).val())}),_.isEmpty(_.difference(f,b.validPhones)))d.submit();else{var g=_.difference(f,b.validPhones);d.request(g[0])}},showError:function(b,c){var d=this;if(d.msgContainer){var e=_.template(propp.tpl);a(d.msgContainer).html(e({phone:b,status:c})).show()}else{var f=a(d.el).find(".propp-phone");_.each(a(f),function(d,e){if(a(d).val()==b){var f=_.template(propp.tpl);a(d).after(f({phone:b,status:c}))}})}}};a(document).ready(function(){a("form").length&&_.each(a("form"),function(c,d){a(c).find(".propp-phone").length&&a(c).on("submit",function(){var d=[],e=a(c).find(".propp-phone");return a(c).find(".propp-error").remove(),_.each(e,function(b,c){d.push(a(e[c]).val())}),_.isEmpty(_.difference(d,b.validPhones))?(a(c).removeClass(propp.form_class),!0):(b.validateForm(a(c)),!1)})})})}(jQuery);